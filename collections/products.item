{.section item}

<div id="productWrapper" class="product ProductItem {@|item-classes}" data-item-id="{id}">

  <div class="ProductItem-nav"><a href="{collection.fullUrl}"><span class="back-arrow">&larr;</span> Back to {collection.title}</a></div>

  <div class="ProductItem-summary clear">

    <section class="ProductItem-details ProductItem-details--mobile">
      <h1 class="ProductItem-details-title" data-content-field="title">{title}</h1>
    </section>

    <div class="ProductItem-gallery">
      <div class="intrinsic">
      <div class="wrapper">
      <div class="ProductItem-gallery-active" id="activeGalleryItem">
      {.section items.0}
        {.image?}
          <img data-load="true" {@|image-meta} />
        {.end}
      {.end}
      </div>
      <div class="ProductItem-gallery-slides">
        {.repeated section items}
          {.image?}
            <div class="ProductItem-gallery-slides-item"><img data-load="true" {@|image-meta} /><div class=""></div></div>
          {.end}
          {.video?}
            {@|video}
          {.end}
        {.end}
      </div>
      </div></div>
      <div class="ProductItem-gallery-thumbnails">
        {.repeated section items}<div class="slide content-fill"><img {@|image-meta} /></div>{.end}
      </div>
    </div>


    <div class="ProductItem-details">
      {@|product-status}

      <h1 class="ProductItem-details-title" data-content-field="title">{title}</h1>

      {@|product-price}

      {.excerpt?}<div class="ProductItem-details-excerpt" data-content-field="excerpt">{excerpt}</div>{.end}

      <div class="customer-journeys">
        <div>
          {@|product-checkout}
        </div>
        <div>
          <squarespace:block-field id="customerJourneyBlock-{item.title}" class="customer-journey-block sqs-alternate-block-style-container" columns="12" label="Customer Journey Blocks" />
        </div>
        <div>
          <div class="ProductItem-details-share">{@|social-button-inline}</div>
        </div>
      </div>
    </div>
  </div>

    {.section body}
      <div class="product-description">
        {@}
      </div>
    {.end}

</div>

<script>

var galleryItems = document.querySelectorAll('.ProductItem-gallery-slides-item')
console.log(galleryItems)

galleryItems.forEach(function(item) {
  item.addEventListener('click', function() { setActiveItem(item) })
})

function setActiveItem(item) {
  var activeItem = document.getElementById('activeGalleryItem')
  var newItem = item.childNodes[0].cloneNode(true)
  activeItem.replaceChild(newItem, activeItem.childNodes[0])
  activeItem.removeChild(activeItem.childNodes[1])
}

</script>

{.end}
